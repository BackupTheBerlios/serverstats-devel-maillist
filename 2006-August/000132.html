<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Serverstats-devel] r163 - in branches/xmlconfig2: config.sample	config.sample/xml includes
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/serverstats-devel/2006-August/index.html" >
   <LINK REL="made" HREF="mailto:serverstats-devel%40lists.berlios.de?Subject=Re%3A%20%5BServerstats-devel%5D%20r163%20-%20in%20branches/xmlconfig2%3A%20config.sample%0A%09config.sample/xml%20includes&In-Reply-To=%3C200608022008.k72K8VBs023345%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000131.html">
   <LINK REL="Next"  HREF="000133.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Serverstats-devel] r163 - in branches/xmlconfig2: config.sample	config.sample/xml includes</H1>
    <B>scramatte at mail.berlios.de</B> 
    <A HREF="mailto:serverstats-devel%40lists.berlios.de?Subject=Re%3A%20%5BServerstats-devel%5D%20r163%20-%20in%20branches/xmlconfig2%3A%20config.sample%0A%09config.sample/xml%20includes&In-Reply-To=%3C200608022008.k72K8VBs023345%40sheep.berlios.de%3E"
       TITLE="[Serverstats-devel] r163 - in branches/xmlconfig2: config.sample	config.sample/xml includes">scramatte at mail.berlios.de
       </A><BR>
    <I>Wed Aug  2 22:08:31 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000131.html">[Serverstats-devel] r162 - in branches/xmlconfig2: config.sample	config.sample/xml config.sample/xml/templates includes
</A></li>
        <LI>Next message: <A HREF="000133.html">[Serverstats-devel] Attribute Value Template on xml parameter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#132">[ date ]</a>
              <a href="thread.html#132">[ thread ]</a>
              <a href="subject.html#132">[ subject ]</a>
              <a href="author.html#132">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: scramatte
Date: 2006-08-02 22:08:28 +0200 (Wed, 02 Aug 2006)
New Revision: 163

Modified:
   branches/xmlconfig2/config.sample/graph.php
   branches/xmlconfig2/config.sample/xml.php
   branches/xmlconfig2/config.sample/xml/tree.xml
   branches/xmlconfig2/includes/xmlconfig.class.php
Log:
Add xmlconfig support for treeview 


Modified: branches/xmlconfig2/config.sample/graph.php
===================================================================
--- branches/xmlconfig2/config.sample/graph.php	2006-08-02 19:09:49 UTC (rev 162)
+++ branches/xmlconfig2/config.sample/graph.php	2006-08-02 20:08:28 UTC (rev 163)
@@ -30,11 +30,15 @@
 
 // List of all Graphs
 $config['list'] = array();
+$config['tree'] = array();
+
 // Add graphs using the simple configuration
 // (To change what graphs are generated by simpleconfig please edit simple.php)
 // simpleconfig::graph($config, $rootConfig['simple']);
 xmlconfig::graph($config, $rootConfig['xml']);
+xmlconfig::tree($config, $rootConfig['xml']);
 
+/*
 $config['tree'] = array(
 	'title' =&gt; 'All graphs',
 	'filter' =&gt; '',
@@ -64,6 +68,9 @@
 		)
 	)
 );
+
+*/
+
 $config['types'] = array(
 //	array('title' =&gt; 'Hour', 'period' =&gt; 3600), // only useful if you have a small step
 	array('title' =&gt; 'Day', 'period' =&gt; 86400),

Modified: branches/xmlconfig2/config.sample/xml/tree.xml
===================================================================
--- branches/xmlconfig2/config.sample/xml/tree.xml	2006-08-02 19:09:49 UTC (rev 162)
+++ branches/xmlconfig2/config.sample/xml/tree.xml	2006-08-02 20:08:28 UTC (rev 163)
@@ -1,7 +1,17 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
-&lt;item xmlns=&quot;urn:serverstats&quot; xmlns:xi=&quot;<A HREF="http://www.w3.org/2001/XInclude">http://www.w3.org/2001/XInclude</A>&quot; xmlns:xsi=&quot;<A HREF="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</A>&quot; title=&quot;All&quot; filter=&quot;&quot; &gt;
-	&lt;item title=&quot;VPS&quot; filter=&quot;groupby:vps&quot; &gt;
-		&lt;item title=&quot;127.0.0.1&quot; filter=&quot;host:127.0.0.1&quot; /&gt;
+&lt;tree xmlns=&quot;urn:serverstats&quot; xmlns:xi=&quot;<A HREF="http://www.w3.org/2001/XInclude">http://www.w3.org/2001/XInclude</A>&quot;&gt;
+	&lt;item&gt;
+		&lt;param name=&quot;title&quot;&gt;All&lt;/param&gt;
+		&lt;param name=&quot;filter&quot; /&gt;
+		&lt;list name=&quot;sub&quot; &gt;
+			&lt;item&gt;
+				&lt;param name=&quot;title&quot;&gt;VPS&lt;/param&gt;
+			        &lt;param name=&quot;filter&quot;&gt;host:127.0.0.1&lt;/param&gt;
+			&lt;/item&gt;
+                        &lt;item&gt;
+                                &lt;param name=&quot;title&quot;&gt;VPS2&lt;/param&gt;
+                                &lt;param name=&quot;filter&quot;&gt;host:127.0.0.1&lt;/param&gt;
+                        &lt;/item&gt;
+		&lt;/list&gt;
 	&lt;/item&gt;
-&lt;/item&gt;
-
+&lt;/tree&gt;

Modified: branches/xmlconfig2/config.sample/xml.php
===================================================================
--- branches/xmlconfig2/config.sample/xml.php	2006-08-02 19:09:49 UTC (rev 162)
+++ branches/xmlconfig2/config.sample/xml.php	2006-08-02 20:08:28 UTC (rev 163)
@@ -75,6 +75,8 @@
 $xmlconfig = xmlconfig::read($xml);
 $config['modules'] = $xmlconfig['modules'];
 $config['graphs'] = $xmlconfig['graphs'];
+$config['tree'] = $xmlconfig['tree'];
+
 $config['used'] = true;
 
 /*
@@ -82,4 +84,6 @@
 print($xml-&gt;saveXML()); 
 */
 
+//print_r($config);
+
 ?&gt;

Modified: branches/xmlconfig2/includes/xmlconfig.class.php
===================================================================
--- branches/xmlconfig2/includes/xmlconfig.class.php	2006-08-02 19:09:49 UTC (rev 162)
+++ branches/xmlconfig2/includes/xmlconfig.class.php	2006-08-02 20:08:28 UTC (rev 163)
@@ -35,17 +35,26 @@
 						break;
 					case 'list':
 						$name = $child-&gt;getAttribute('name');
+						if ($name=='') $name = count($config);
 						self::__traverseParams($child, $config[ $name ]);
+
 						break;
 					case 'param':							
 						$name = $child-&gt;getAttribute('name');
 						if ($name=='') $name = count($config);
-						
+	
 						$config[ $name ] = $child-&gt;nodeValue;
 						self::__traverseParams($child, $config);
 
 						break;
+					case 'tree':
+						self::__traverseParams($child, $config['tree']);
+						break;
 
+					case 'item':
+						self::__traverseParams($child, $config[]);
+						break;
+
 					default:
 						//print $child-&gt;nodeName;
 						self::__traverseParams($child, $config);		
@@ -57,6 +66,22 @@
 	}
 
 
+	public static function tree(&amp;$config, $xmlconfig)
+        {
+            if (!$xmlconfig['used'])
+                {
+                        return;
+                }
+
+		
+		foreach ($xmlconfig['tree'] as $tree =&gt; $treeconf)
+                {
+                         $config['tree'] = $treeconf;
+                }
+
+	}
+
+
 	public static function graph(&amp;$config, $xmlconfig)
 	{
             if (!$xmlconfig['used'])
@@ -69,7 +94,7 @@
 		{
 			 $config['list'][] = $graphconf;
 		}
-		
+
 	}
 
 	public static function sources(&amp;$config, $xmlconfig)
@@ -79,7 +104,7 @@
                         return;
                 }
 
-		
+	
 		foreach ($xmlconfig['modules'] as $module =&gt; $modconf)
 		{
 			$config[ $module ]['module'] = $modconf;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000131.html">[Serverstats-devel] r162 - in branches/xmlconfig2: config.sample	config.sample/xml config.sample/xml/templates includes
</A></li>
	<LI>Next message: <A HREF="000133.html">[Serverstats-devel] Attribute Value Template on xml parameter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#132">[ date ]</a>
              <a href="thread.html#132">[ thread ]</a>
              <a href="subject.html#132">[ subject ]</a>
              <a href="author.html#132">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/serverstats-devel">More information about the Serverstats-devel
mailing list</a><br>
</body></html>
